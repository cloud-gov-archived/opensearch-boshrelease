# NOTE: All parsed data should include @message, @level and @source.component.
# Otherwise these fields are set from syslog_ fields in teardown script afterwards.

# NOTE: @timestamp for CF components logs is set in opensearch-boshrelease from syslog_timestamp (timestamp set by metron_agent).

# Setup snippet (should precede all other snippets)
<%= File.read('src/logstash-filters/snippets/setup.conf') %>

##-- App
# (App snippet should precede all other app snippets)
<%= File.read('src/logstash-filters/snippets/app.conf') %>
# special cases parsing
<%= File.read('src/logstash-filters/snippets/app-logmessage.conf') %>
<%= File.read('src/logstash-filters/snippets/app-logmessage-app.conf') %>
<%= File.read('src/logstash-filters/snippets/app-logmessage-rtr.conf') %>
<%= File.read('src/logstash-filters/snippets/app-error.conf') %>
<%= File.read('src/logstash-filters/snippets/app-metric.conf') %>
<%= File.read('src/logstash-filters/snippets/app-http.conf') %>

# Teardown snippet (should follow all other snippets)
<%= File.read('src/logstash-filters/snippets/teardown.conf') %>
