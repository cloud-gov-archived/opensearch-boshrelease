- azs:
  - z1
  instances: 1
  jobs:
  - name: bpm
    release: bpm
  - consumes:
      opensearch:
        from: opensearch_manager
    name: opensearch
    properties:
      elasticsearch:
        heap_size: 1G
        jvm_options:
        - -Dlog4j2.formatMsgNoLookups=true
    release: opensearch
  - consumes:
      opensearch:
        from: opensearch_manager
    name: ingestor_syslog
    properties:
      logstash:
        jvm_options:
        - -Dlog4j2.formatMsgNoLookups=true
        queue:
          max_bytes: 30gb
      logstash_parser:
        deployment_dictionary:
        - /var/vcap/packages/opensearch_config/deployment_lookup.yml
        - /var/vcap/jobs/parser-config-lfc/config/deployment_lookup.yml
        opensearch:
          data_hosts:
          - 127.0.0.1
          index: logs-app-%{+YYYY.MM.dd}
          index_type: '%{@type}'
        filters:
        - logsearch-for-cf: /var/vcap/packages/opensearch-config-logstash-filters/logstash-filters-default.conf
    provides:
      ingestor:
        as: ingestor_link
    release: opensearch
  - name: ingestor_cloudfoundry-firehose
    properties:
      cloudfoundry:
        api_endpoint: https://api.dev.us-gov-west-1.aws-us-gov.cloud.gov
        firehose_cc_pull_interval: 300s
        firehose_client_id: openearch_firehose_ingestor
        firehose_client_secret: ((logs_opensearch_firehose_client_secret))
        firehose_events:
        - LogMessage
        - ContainerMetric
        firehose_subscription_id: opensearch-ingestor
        skip_ssl_validation: false
      syslog:
        host: 127.0.0.1
        port: 5514
    release: opensearch
  - name: parser-config-lfc
    release: opensearch
  name: ingestor
  networks:
  - name: services
  persistent_disk_type: logsearch_ingestor
  stemcell: default
  vm_type: t3.medium